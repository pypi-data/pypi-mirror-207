{"version":3,"file":"lib_widget_js.e581d1c3446a69e4da81.js","mappings":"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","sources":["webpack://react-editable-table/./src/react/ReactEditableTable.tsx","webpack://react-editable-table/./src/react/model.ts","webpack://react-editable-table/./src/version.ts","webpack://react-editable-table/./src/widget.ts"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  Table,\n  Input,\n  createStyles,\n  ScrollArea,\n  Loader,\n  Box,\n  MantineProvider,\n} from '@mantine/core';\nimport { useMutationObserver } from 'ahooks';\nimport { WidgetModel } from '@jupyter-widgets/base';\nimport { useModelMessenger, useModelState, WidgetModelContext } from './model';\n\nconst useStyles = createStyles({\n  table: {\n    borderRadius: 8,\n    borderCollapse: 'initial',\n    overflow: 'hidden',\n\n    '& thead tr th': {\n      height: 50,\n      textAlign: 'left',\n      padding: '0.4375rem 0.625rem',\n    },\n    '& thead tr th:nth-of-type(1)': {\n      width: 140,\n    },\n    '& thead tr th:nth-of-type(2)': {\n      width: 140,\n    },\n  },\n});\n\ninterface WidgetProps {\n  model: WidgetModel;\n  loading?: boolean;\n}\n\nfunction ReactEditableTable(props: WidgetProps) {\n  const [columns] = useModelState('columns');\n  const [meta] = useModelState('meta');\n  const [data, setData] = useModelState('data');\n  const send = useModelMessenger();\n  const { classes } = useStyles();\n  const { loading } = props;\n\n  const rows = data.map((item, index) => {\n    return (\n      <tr key={index}>\n        {columns.map((c) => (\n          <td key={c.header}>\n            {c.editable ? (\n              <Input\n                type=\"text\"\n                defaultValue={item[c.accessor]}\n                onBlur={(e: any) => {\n                  const next = e.target.value;\n                  if (item[c.accessor] !== next) {\n                    const data = { ...item, [c.accessor]: e.target.value };\n                    setData((prev) => {\n                      prev[index] = data;\n                    });\n\n                    send({\n                      type: 'cell-changed',\n                      payload: {\n                        row: data,\n                        index,\n                        meta,\n                      },\n                    });\n                  }\n                }}\n              />\n            ) : (\n              item[c.accessor]\n            )}\n          </td>\n        ))}\n      </tr>\n    );\n  });\n\n  return (\n    <div>\n      <ScrollArea mah={400}>\n        <Box maw={600}>\n          <Table cellSpacing={0} className={classes.table}>\n            <thead>\n              <tr>\n                {columns.map((i) => (\n                  <th key={i.header}>{i.header}</th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>{rows}</tbody>\n          </Table>\n        </Box>\n      </ScrollArea>\n\n      {loading && (\n        <Loader size=\"xs\" sx={{ position: 'absolute', top: 5, right: 0 }} />\n      )}\n    </div>\n  );\n}\n\nfunction withModelContext(Component: (props: WidgetProps) => JSX.Element) {\n  return (props: WidgetProps) => {\n    const [dark, setDark] = useState(\n      () => document.body.dataset.jpThemeLight === 'false'\n    );\n    useMutationObserver(\n      (mutationsList) => {\n        mutationsList.forEach((i) => {\n          if (i.attributeName === 'data-jp-theme-light') {\n            setDark(document.body.dataset.jpThemeLight === 'false');\n          }\n        });\n      },\n      document.body,\n      {\n        attributes: true,\n        subtree: false,\n      }\n    );\n\n    return (\n      <WidgetModelContext.Provider value={props.model}>\n        <MantineProvider\n          theme={{ colorScheme: dark ? 'dark' : 'light' }}\n          withGlobalStyles\n          withNormalizeCSS\n        >\n          <Component {...props} />\n        </MantineProvider>\n      </WidgetModelContext.Provider>\n    );\n  };\n}\n\nexport default withModelContext(ReactEditableTable);\n","import {\n  createContext,\n  useContext,\n  useEffect,\n  DependencyList,\n  useState,\n} from 'react';\nimport { WidgetModel } from '@jupyter-widgets/base';\nimport { produce } from 'immer';\nimport { WidgetModelState } from '../widget';\n\nexport const WidgetModelContext = createContext<WidgetModel | undefined>(\n  undefined\n);\n\n// TYPES AND INTERFACES\n//============================================================================================\n\ninterface ModelCallback {\n  (model: WidgetModel, event: Backbone.EventHandler): void;\n}\n\n// HOOKS\n//============================================================================================\n\n/**\n *\n * @param name property name in the Python model object.\n * @returns model state and set state function.\n */\nexport function useModelState<T extends keyof WidgetModelState>(\n  name: T\n): [\n  WidgetModelState[T],\n  (updater: (draft: WidgetModelState[T]) => void, options?: any) => void\n] {\n  const model = useModel();\n  const [state, setState] = useState<WidgetModelState[T]>(model?.get(name));\n\n  function setter(\n    updater: (draft: WidgetModelState[T]) => void,\n    options?: any\n  ) {\n    const next = produce(state, updater);\n    model?.set(name, next, options);\n    model?.save_changes();\n  }\n\n  useModelEvent(\n    `change:${name}`,\n    (model) => {\n      setState(model.get(name));\n    },\n    [name]\n  );\n\n  return [state, setter];\n}\n\n/**\n * Subscribes a listener to the model event loop.\n * @param event String identifier of the event that will trigger the callback.\n * @param callback Action to perform when event happens.\n * @param deps Dependencies that should be kept up to date within the callback.\n */\nexport function useModelEvent(\n  event: string,\n  callback: ModelCallback,\n  deps?: DependencyList | undefined\n) {\n  const model = useModel();\n  const dependencies = deps === undefined ? [model] : [...deps, model];\n\n  useEffect(() => {\n    const callbackWrapper = (e: Backbone.EventHandler) => {\n      model && callback(model, e);\n    };\n\n    model?.on(event, callbackWrapper);\n\n    return () => {\n      model?.unbind(event, callbackWrapper);\n    };\n  }, dependencies);\n}\n\n/**\n * An escape hatch in case you want full access to the model.\n * @returns Python model\n */\nexport function useModel() {\n  return useContext(WidgetModelContext);\n}\n\ninterface MessageCellChanged {\n  type: 'cell-changed';\n  payload: {\n    row: any;\n    index: number;\n    meta?: any;\n  };\n}\n\ntype Message = MessageCellChanged;\n\nexport function useModelMessenger() {\n  const model = useModel();\n\n  function send(message: Message) {\n    model?.send(message as any);\n  }\n\n  return send;\n}\n","// Copyright (c) zoubingwu\n// Distributed under the terms of the Modified BSD License.\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst data = require('../package.json');\n\n/**\n * The _model_module_version/_view_module_version this package implements.\n *\n * The html widget manager assumes that this is the same as the npm package\n * version number.\n */\nexport const MODULE_VERSION = data.version;\n\n/*\n * The current package name.\n */\nexport const MODULE_NAME = data.name;\n","// Copyright (c) zoubingwu\n// Distributed under the terms of the Modified BSD License.\nimport {\n  DOMWidgetModel,\n  DOMWidgetView,\n  ISerializers,\n} from '@jupyter-widgets/base';\nimport ReactEditableTable from './react/ReactEditableTable';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { MODULE_NAME, MODULE_VERSION } from './version';\n\ninterface Column {\n  header: string;\n  accessor: string;\n  editable?: boolean;\n}\n\nexport interface WidgetModelState {\n  columns: Column[];\n  data: any[];\n  loading?: boolean;\n  meta?: Record<string, any>;\n}\n\n// Your widget state goes here. Make sure to update the corresponding\n// Python state in example.py\nconst defaultModelProperties: WidgetModelState = {\n  columns: [],\n  data: [],\n};\n\nexport class TableModel extends DOMWidgetModel {\n  defaults() {\n    return {\n      ...super.defaults(),\n      _model_name: TableModel.model_name,\n      _model_module: TableModel.model_module,\n      _model_module_version: TableModel.model_module_version,\n      _view_name: TableModel.view_name,\n      _view_module: TableModel.view_module,\n      _view_module_version: TableModel.view_module_version,\n      ...defaultModelProperties,\n    };\n  }\n\n  static serializers: ISerializers = {\n    ...DOMWidgetModel.serializers,\n    // Add any extra serializers here\n  };\n\n  static model_name = 'TableModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n  static view_name = 'TableView'; // Set to null if no view\n  static view_module = MODULE_NAME; // Set to null if no view\n  static view_module_version = MODULE_VERSION;\n\n  initialize(attributes: any, options: any) {\n    super.initialize(attributes, options);\n\n    this.on('msg:custom', (message) => {\n      this.send(message);\n    });\n  }\n}\n\nexport class TableView extends DOMWidgetView {\n  render() {\n    const component = React.createElement(ReactEditableTable, {\n      model: this.model,\n    });\n    ReactDOM.render(component, this.el);\n  }\n}\n"],"names":[],"sourceRoot":""}