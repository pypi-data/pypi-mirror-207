function mockChooseImage(){var a=wx.getFileSystemManager();if(!global.__minium_mock_choose_image){var b=function rewriteChooseImage(a,b){function d(){c&&(c=!1,h.forEach(function(b){f[b]?f[b].get?Object.defineProperty(a,b,{configurable:!0,get:function get(){return e[b]}}):Object.defineProperty(a,b,{writable:!0,value:e[b]}):a[b]=e[b]}))}if(c)return!1;c=!0;var e={},f={},g={chooseImage:function chooseImage(a){d();var c={errMsg:"chooseImage:ok",tempFilePaths:b.map(function(a){return a.filePath}),tempFiles:b.map(function(a){return{path:a.filePath,size:a.size}})};return a.success||a.fail||a.complete?void(a.success&&a.success(c),a.complete&&a.complete(c)):Promise.resolve(c)},chooseMedia:function chooseMedia(a){d();var c={errMsg:"chooseMedia:ok",tempFiles:b.map(function(a){return{tempFilePath:a.filePath,size:a.size,fileType:"image"}}),type:"image"};return a.success||a.fail||a.complete?void(a.success&&a.success(c),a.complete&&a.complete(c)):Promise.resolve(c)},createCameraContext:function createCameraContext(){var a=e.createCameraContext(),f=a.takePhoto;return Object.defineProperty(a,"takePhoto",{configurable:!0,get:function get(){return function(a){if(!c)return f.call(this,a);d();var e={tempImagePath:b[0].filePath,errMsg:"takePhoto:ok"};a.success&&a.success(e),a.complete&&a.complete(e)}}}),a}},h=Object.keys(g);return h.forEach(function(b){e[b]=a[b],f[b]=Object.getOwnPropertyDescriptor(a,b)}),h.forEach(function(b){f[b]?f[b].get?Object.defineProperty(a,b,{configurable:!0,get:function get(){return g[b]}}):Object.defineProperty(a,b,{writable:!0,value:g[b]}):a[b]=g[b]}),!0},c=!1;global.__minium_mock_choose_image=function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];var f=d.map(function(b){var c=b.imageData,d=b.imageName,e=b.size,f="".concat(wx.env.USER_DATA_PATH,"/.MINIUM_TMP/").concat(d);return c&&0!==c.length?new Promise(function(b,e){a.writeFile({filePath:f,data:c,encoding:"base64",success:function success(){a.stat({path:f,success:function success(a){var c=a.stats;b({imageName:d,filePath:f,size:c.size})}})},fail:function fail(a){var b=a.errMsg;"writeFile:fail the maximum size of the file storage limit is exceeded"===b?e(new Error("\u5C0F\u7A0B\u5E8F\u6587\u4EF6\u7A7A\u95F4\u4E0D\u8DB3")):"writeFile:fail sdcard not mounted"===b?e(new Error("sdcard\u672A\u6302\u8F7D")):e(new Error("Mock\u5931\u8D25: ".concat(b)))}})}):Promise.resolve({imageName:d,filePath:f,size:e})});return Promise.all(f).then(function(a){return b(wx,a),a.map(function(a){return{name:a.imageName,size:a.size}})})};var d=!1;a.mkdir({dirPath:"".concat(wx.env.USER_DATA_PATH,"/.MINIUM_STORE"),recursive:!1,success:function success(){d=!0},fail:function fail(a){var b=a.errMsg;0<=b.indexOf("file already exists")&&(d=!0)}});var e=a.saveFile,f=a.saveFileSync,g=a.getSavedFileList;Object.defineProperty(a,"saveFile",{configurable:!0,get:function get(){return function(b){var c=b.tempFilePath,d=b.filePath,f=b.success,g=b.fail,h=b.complete;if(c.startsWith("".concat(wx.env.USER_DATA_PATH,"/.MINIUM_TMP"))){var i={srcPath:c,destPath:d||"".concat(wx.env.USER_DATA_PATH,"/.MINIUM_STORE/").concat(c.split("/").pop())};return f&&(i.success=function(a){a.errMsg=a.errMsg.replace("copyFile","saveFile"),a.savedFilePath=i.destPath,f(a)}),g&&(i.fail=function(a){a.errMsg=a.errMsg.replace("copyFile","saveFile"),g(a)}),h&&(i.complete=function(a){a.errMsg=a.errMsg.replace("copyFile","saveFile"),0===a.errMsg.indexOf("saveFile:ok")&&(a.savedFilePath=i.destPath),h(a)}),a.copyFile(i)}return e({tempFilePath:c,filePath:d,success:f,fail:g,complete:h})}}}),Object.defineProperty(a,"saveFileSync",{configurable:!0,get:function get(){return function(b,c){if(b.startsWith("".concat(wx.env.USER_DATA_PATH,"/.MINIUM_TMP"))){var d=b,e=c||"".concat(wx.env.USER_DATA_PATH,"/.MINIUM_STORE/").concat(b.split("/").pop());try{return a.copyFileSync(d,e),e}catch(a){throw a.message.replace("copyFileSync","saveFileSync")}}return f(b,c)}}}),Object.defineProperty(a,"getSavedFileList",{configurable:!0,get:function get(){return function(b){var c=b.success,d=b.complete;Promise.all([new Promise(function(b){a.stat({path:"".concat(wx.env.USER_DATA_PATH,"/.MINIUM_STORE/"),recursive:!0,complete:function complete(a){b((a.stats||[]).filter(function(a){return"/"!==a.path}).map(function(a){return{filePath:"".concat(wx.env.USER_DATA_PATH,"/.MINIUM_STORE/").concat(a.path.startsWith("/")?a.path.slice(1):a.path),size:a.stats.size,createTime:a.stats.lastModifiedTime}}))}})}),new Promise(function(a){g({complete:function complete(b){a(b.fileList||[])}})})]).then(function(a){var b=global.babelHelpers.slicedToArray(a,2),e=b[0],f=b[1],g={fileList:e.concat(f),errMsg:"getSavedFileList:ok"};c&&c(g),d&&d(g)})}}})}return new Promise(function(b,c){a.mkdir({dirPath:"".concat(wx.env.USER_DATA_PATH,"/.MINIUM_TMP"),recursive:!1,success:function success(){b([])},fail:function fail(d){var e=d.errMsg;return 0<=e.indexOf("file already exists")?void a.stat({path:"".concat(wx.env.USER_DATA_PATH,"/.MINIUM_TMP/"),recursive:!0,success:function success(a){return console.warn("[debug]fs.stat success"),a.stats.length?void b(a.stats.map(function(a){return{name:a.path.replace(/^\//,""),size:a.stats.size}}).filter(function(a){return a.name})):b([])},fail:c}):void c({errMsg:e})}})})}