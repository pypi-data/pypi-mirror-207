import{i as Q,k as ee,j as te,r as D,c as T,o as ie,z as s,a2 as E,d as le,v as x,w as oe,l as d,B as f,f as t,q as a,x as q,C as u,s as n,y as p,n as C,A as c,am as k,P as O,m as F}from"./index-4822884e.js";import{s as ae}from"./vue-virtual-scroller.esm-60e1261b.js";/* empty css                             */import{_ as ne,f as ue,t as se}from"./utils-9ffe70c1.js";import{V as G,a as de}from"./VTabs-710bb267.js";import{V as H}from"./VAlert-c8753807.js";import{V as g,a as $,d as re}from"./VCardText-4f782ffb.js";import{V as J}from"./VTooltip-c3262e6e.js";import{V as M,b as V}from"./VBtn-100eb5c9.js";import{V as y}from"./VDivider-ef9e8070.js";import{a as me}from"./VCard-8d6cfe56.js";import{V as pe,b as W}from"./VToolbar-1a1dbef8.js";import{V as _e}from"./forwardRefs-29398c77.js";import{V as ve}from"./VDialog-057042a1.js";const fe={style:{"padding-left":"15px","padding-right":"-15px","padding-top":"10px","padding-bottom":"20px"}},ce=p("br",null,null,-1),ge={key:0},ye={class:"listitem-thumb"},be={key:0},qe={key:1},Ce={key:2},ke={class:"listitem-actions"},$e={key:0,class:"listitem-action"},Ve={key:1,class:"listitem-action"},we={key:2,class:"listitem-action"},Le=Q({__name:"PlayerQueue",setup(he){const{t:X}=ee(),B=te(),U=D(0),r=D(),I=D(!1),b=D([]),e=T(()=>{if(x.selectedPlayer)return s.queues[x.selectedPlayer.active_source]}),Y=T(()=>{if(e.value)return e.value.current_item}),N=T(()=>e.value?b.value.slice(e.value.current_index):[]),S=T(()=>e.value?b.value.slice(0,e.value.current_index):[]),Z=T(()=>U.value==1?S.value:N.value);ie(()=>{const i=s.subscribe_multi([E.QUEUE_UPDATED,E.QUEUE_ITEMS_UPDATED],l=>{var h;l.object_id==((h=e.value)==null?void 0:h.queue_id)&&(l.event==E.QUEUE_ITEMS_UPDATED?z():L())});le(i)});const z=async function(){e.value?(x.topBarTitle=e.value.display_name,b.value=[],await s.getPlayerQueueItems(e.value.queue_id,i=>{console.log("chunk",i.length),b.value.push(...i)})):(x.topBarTitle=void 0,b.value=[])},R=function(i){r.value=i,I.value=!0},j=function(i){A(),B.push({name:i.media_type,params:{itemId:i.item_id,provider:i.provider}})},w=function(i,l){A(),!(!i||!e.value)&&(l=="play_now"?s.queueCommandPlayIndex(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="move_next"?s.queueCommandMoveNext(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="up"?s.queueCommandMoveUp(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="down"?s.queueCommandMoveDown(e==null?void 0:e.value.queue_id,i.queue_item_id):l=="delete"&&s.queueCommandDelete(e==null?void 0:e.value.queue_id,i.queue_item_id))},L=function(){x.topBarContextMenuItems=[{label:"settings.player_settings",labelArgs:[],action:()=>{B.push(`/settings/editplayer/${e.value.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{s.queueCommandClear(e.value.queue_id)},icon:"mdi-cancel"},{label:e.value.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{s.queueCommandShuffleToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[X(`repeatmode.${e.value.repeat_mode}`)],action:()=>{s.queueCommandRepeatToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"},{label:e.value.crossfade_enabled?"crossfade_enabled":"crossfade_disabled",labelArgs:[],action:()=>{s.queueCommandCrossfadeToggle(e.value.queue_id)},icon:e.value.crossfade_enabled?"mdi-swap-horizontal-bold":"mdi-swap-horizontal"}]},A=function(){r.value=void 0,I.value=!1};return oe(()=>e.value,i=>{i&&(z(),L())},{immediate:!0}),(i,l)=>{var h;return d(),f("section",null,[t(de,{modelValue:U.value,"onUpdate:modelValue":l[0]||(l[0]=o=>U.value=o),"show-arrows":"",grow:""},{default:a(()=>[t(G,{value:0},{default:a(()=>[q(u(i.$t("queue_next_items")+" ("+n(N).length+")"),1)]),_:1}),t(G,{value:1},{default:a(()=>[q(u(i.$t("queue_previous_items")+" ("+n(S).length+")"),1)]),_:1})]),_:1},8,["modelValue"]),p("div",fe,[n(e)&&((h=n(e))==null?void 0:h.radio_source.length)>0?(d(),C(H,{key:0,color:"primary",theme:"dark",icon:"mdi-radio-tower",prominent:"",style:{"margin-right":"10px"}},{default:a(()=>{var o,v,m,_;return[p("b",null,u(i.$t("queue_radio_enabled")),1),ce,q(" "+u(i.$t("queue_radio_based_on",[i.$t((o=n(e))==null?void 0:o.radio_source[0].media_type)]))+" ",1),p("b",null,[p("a",{onClick:l[1]||(l[1]=P=>{var K;return n(e)?j((K=n(e))==null?void 0:K.radio_source[0]):""})},u((v=n(e))==null?void 0:v.radio_source[0].name),1)]),((m=n(e))==null?void 0:m.radio_source.length)>1?(d(),f("span",ge," (+"+u(((_=n(e))==null?void 0:_.radio_source.length)-1)+")",1)):c("",!0)]}),_:1})):c("",!0),t(n(ae),{items:n(Z),"item-size":66,"key-field":"queue_item_id","page-mode":""},{default:a(({item:o})=>{var v;return[p("div",null,[t(g,{ripple:"",disabled:o.queue_item_id==((v=n(Y))==null?void 0:v.queue_item_id),onClick:k(m=>R(o),["stop"]),onContextmenu:k(m=>R(o),["right","prevent"])},{prepend:a(()=>[p("div",ye,[t(ne,{item:o,width:"50px",height:"50px"},null,8,["item"])])]),title:a(()=>[q(u(o.media_item?o.media_item.name:o.name),1)]),subtitle:a(()=>[o.media_item&&"artists"in o.media_item&&o.media_item.artists.length>0?(d(),f("div",be,u(o.media_item.artists[0].name),1)):o.media_item?(d(),f("div",qe,u(o.media_item.metadata.description),1)):(d(),f("div",Ce,u(o.uri),1))]),append:a(()=>{var m;return[p("div",ke,[o.duration&&((m=o.media_item)==null?void 0:m.media_type)!=n(O).RADIO?(d(),f("div",$e,[p("span",null,u(n(ue)(o.duration)),1)])):c("",!0),i.$vuetify.display.mobile?c("",!0):(d(),f("div",Ve,[t(J,{location:"bottom"},{activator:a(({props:_})=>[t(M,F({variant:"plain",ripple:""},_,{icon:"mdi-arrow-up",onClick:[P=>n(s).queueCommandMoveUp(n(e).queue_id,o.queue_item_id),l[2]||(l[2]=k(()=>{},["prevent"])),l[3]||(l[3]=k(()=>{},["stop"]))]}),null,16,["onClick"])]),default:a(()=>[p("span",null,u(i.$t("queue_move_up")),1)]),_:2},1024)])),i.$vuetify.display.mobile?c("",!0):(d(),f("div",we,[t(J,{location:"bottom"},{activator:a(({props:_})=>[t(M,F({variant:"plain",ripple:""},_,{icon:"mdi-arrow-down",onClick:[P=>n(s).queueCommandMoveDown(n(e).queue_id,o.queue_item_id),l[4]||(l[4]=k(()=>{},["prevent"])),l[5]||(l[5]=k(()=>{},["stop"]))]}),null,16,["onClick"])]),default:a(()=>[p("span",null,u(i.$t("queue_move_down")),1)]),_:2},1024)]))])]}),_:2},1032,["disabled","onClick","onContextmenu"]),t(y)])]}),_:1},8,["items"]),b.value.length==0?(d(),C(H,{key:1,type:"info",style:{margin:"20px"}},{default:a(()=>[q(u(i.$t("no_content")),1)]),_:1})):c("",!0)]),t(ve,{modelValue:I.value,"onUpdate:modelValue":l[13]||(l[13]=o=>I.value=o),fullscreen:i.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:a(()=>[t(me,null,{default:a(()=>[t(pe,{sense:"",dark:"",color:"primary"},{default:a(()=>[t(M,{icon:"mdi-play-circle-outline"}),r.value?(d(),C(W,{key:0,style:{"padding-left":"10px"}},{default:a(()=>{var o;return[p("b",null,u(n(se)(((o=r.value)==null?void 0:o.name)||"",i.$vuetify.display.mobile?20:150)),1)]}),_:1})):(d(),C(W,{key:1,style:{"padding-left":"10px"}},{default:a(()=>{var o;return[p("b",null,u(i.$t("settings")),1),q(" | "+u((o=n(e))==null?void 0:o.display_name),1)]}),_:1})),t(M,{icon:"mdi-close",dark:"",onClick:l[6]||(l[6]=o=>A())})]),_:1}),r.value?(d(),C(re,{key:0},{default:a(()=>[t(_e,null,{default:a(()=>{var o,v;return[t(g,{title:i.$t("play_now"),onClick:l[7]||(l[7]=m=>w(r.value,"play_now"))},{prepend:a(()=>[t($,{style:{"padding-right":"10px"}},{default:a(()=>[t(V,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("play_next"),onClick:l[8]||(l[8]=m=>w(r.value,"move_next"))},{prepend:a(()=>[t($,{style:{"padding-right":"10px"}},{default:a(()=>[t(V,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("queue_move_up"),onClick:l[9]||(l[9]=m=>w(r.value,"up"))},{prepend:a(()=>[t($,{style:{"padding-right":"10px"}},{default:a(()=>[t(V,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("queue_move_down"),onClick:l[10]||(l[10]=m=>w(r.value,"down"))},{prepend:a(()=>[t($,{style:{"padding-right":"10px"}},{default:a(()=>[t(V,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),t(y),t(g,{title:i.$t("queue_delete"),onClick:l[11]||(l[11]=m=>w(r.value,"delete"))},{prepend:a(()=>[t($,{style:{"padding-right":"10px"}},{default:a(()=>[t(V,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),t(y),((v=(o=r.value)==null?void 0:o.media_item)==null?void 0:v.media_type)==n(O).TRACK?(d(),C(g,{key:0,title:i.$t("show_info"),onClick:l[12]||(l[12]=m=>{var _;return(_=r.value)!=null&&_.media_item?j(r.value.media_item):""})},{prepend:a(()=>[t($,{style:{"padding-right":"10px"}},{default:a(()=>[t(V,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):c("",!0),t(y)]}),_:1})]),_:1})):c("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}});export{Le as default};
